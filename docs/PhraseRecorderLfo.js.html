<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Documentation - Source: PhraseRecorderLfo.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/overrides.css">
</head>

<body>

<div id="main">

    <!-- if home page assume a title is already present in README -->
    
    <h1 class="page-title">Source: PhraseRecorderLfo.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import * as lfo from 'waves-lfo';
import { PhraseMaker } from 'xmm-client';

/**
 * Lfo class extending lfo.sinks.DataRecorder, using PhraseMaker from xmm-client
 * to format the input data for xmm-node.
 * @class
 */
class PhraseRecorderLfo extends lfo.sinks.DataRecorder {
	constructor(options = {}) {
		const defaults = {
			separateArrays: true,
			bimodal: false,
			dimension_input: 0,
			column_names: ['']
		}
		Object.assign(defaults, options);
		super(defaults);

		this._phraseMaker = new PhraseMaker(this.params);

		this.updatePhrase = ((data) => {
			for (let vecid in data.data) {
				const obs = [];
				for (let id in data.data[vecid]) {
					obs.push(data.data[vecid][id]);
				}
				//console.log(obs);
				this._phraseMaker.addObservation(obs);
			}
			this.retrieve()
				.then(this.updatePhrase.bind(this))
				.catch((err) => console.error(err.stack));
		});

		this.retrieve()
			.then(this.updatePhrase.bind(this))
			.catch((err) => console.error(err.stack));
	}

	/**
	 * The current label of the last / currently being recorded phrase.
	 * @type {String}
	 */
	get label() {
		return this.phraseMaker.config.label;
	}

	set label(label) {
		this._phraseMaker.config = { label: label };
	}

	/**
	 * Start recording a phrase from the input stream.
	 */
	start() {
		this._phraseMaker.reset(); // is this better here than in stop() ?
		super.start();
	}

	/**
	 * Stop the current recording.
	 * (makes the phrase available via &lt;code>getRecordedPhrase()&lt;/code>).
	 */
	stop() {
		super.stop();
		//this._phraseMaker.reset();
	}

	/** @private */
	initialize(streamParams = {}) {
		super.initialize(streamParams);
		this._phraseMaker.config = { dimension: this.streamParams.frameSize };
		this._phraseMaker.reset();
	}

	/**
	 * Returns the latest recorded phrase.
	 */
	getRecordedPhrase() {
		return this._phraseMaker.phrase;
	}
}

export default PhraseRecorderLfo;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="GmmDecoderLfo.html">GmmDecoderLfo</a></li><li><a href="HhmmDecoderLfo.html">HhmmDecoderLfo</a></li><li><a href="PhraseRecorderLfo.html">PhraseRecorderLfo</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Oct 27 2016 18:20:30 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
